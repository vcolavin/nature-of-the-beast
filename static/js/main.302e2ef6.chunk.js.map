{"version":3,"sources":["store.ts","utils/SpeechUtilities.ts","utils/uuid.ts","utils/OutputController.ts","utilities/BaseUtility.ts","utilities/Echo.ts","utilities/Help.ts","nouns/Location.ts","nouns/LocationManifest.ts","utilities/Ls.tsx","utilities/WhoAmI.ts","nouns/Item.ts","nouns/ItemManifest.ts","utilities/Look.ts","utilities/Cd.ts","utilities/Time.tsx","utilities/Pickup.ts","utilities/Inventory.ts","utilities/Mute.ts","utilities/Clear.ts","utilities/UtilityManifest.ts","components/TerminalBuffer.tsx","components/TerminalInput.tsx","components/Terminal.tsx","components/App.tsx","index.tsx"],"names":["ActionTypes","initialState","location","consoleInteractive","inventory","history","soundOn","store","createStore","state","arguments","length","undefined","action","type","SET_LOCATION","Object","objectSpread","value","LOCK_CONSOLE","RELEASE_CONSOLE","ADD_TO_INVENTORY","toConsumableArray","concat","PUSH_HISTORY","CLEAR_HISTORY","TOGGLE_SOUND","voices","speechSynthesis","getVoices","filter","_ref","lang","indexOf","moira","voice","name","victoria","uuid","a","Math","random","toString","replace","OutputController","dispatch","item","historyManifest","id","content","pushToStoreHistory","_historyManifest","revoked","curriedOutputter","curry","output","revocableOutputter","revoke","args","Promise","resolve","revocableOutputters","push","forEach","outputter","this","revokeOutputters","window","cancel","speak","speechPromise","text","getState","utterance","SpeechSynthesisUtterance","pitch","rate","onend","setTimeout","say","pushItem","BaseUtility","command","aliases","helpDescription","params","getRevocableOutputter","_run","Echo","join","Help","helpMessage","keys","UtilityManifest","util","ExtendedUtilityManifest","Location","_this","descriptions","slug","classCallCheck","hasNeighbor","neighbor","neighborSlugs","hasItem","itemSlugs","LocationManifest","hasRun","LsComponent","props","react_default","createElement","places","map","place","key","className","TAB_WIDTH","items","Ls","Ls_LsComponent","sort","responses","WhoAmI","reduce","memo","then","Item","locationSlug","takeable","ItemManifest","Look","getTabCompleteOptions","_ref2","subject","Cd","path","locations","split","locationChain","splice","finalFragment","locationChainValid","finalLocationInChain","options","i","prevLocation","nullPromise","l","finalLocation","setUrlLocation","_ref3","hash","TimeComponent","interval","Date","getTime","_this2","setInterval","setState","clearInterval","React","Component","Time","Time_TimeComponent","Pickup","currentLocation","itemSlug","Inventory","Mute","Clear","clearHistory","connect","terminalHistory","itemId","TerminalInput","possibleConstructorReturn","getPrototypeOf","call","commandHistory","currentPlaceInHistory","inputValue","focusInput","inputEl","current","focus","goBackInHistory","goForwardInHistory","moveCursorToEnd","selectionStart","handleChange","e","target","handleKeyDown","preventDefault","tabComplete","addToCommandHistory","handleSubmit","_this$state$inputValu","_this$state$inputValu2","toArray","rest","slice","lastValue","utility","_this$props","_state","locationString","newValue","inputPrompt","createRef","addEventListener","removeEventListener","onKeyDown","onChange","ref","Terminal","handleKeydown","typedEvent","ctrlKey","stopOutput","runCommand","_value$trim$split","trim","_value$trim$split2","utilityName","run","catch","console","error","_this$props2","components_TerminalBuffer","components_TerminalInput","INITIAL_LOCATION_SLUG","App","neighbors","from","to","oneWay","alias","components_Terminal","ReactDOM","render","es","components_App","document","getElementById"],"mappings":"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","file":"static/js/main.302e2ef6.chunk.js","sourcesContent":["import { createStore, Dispatch } from 'redux';\nimport { HistoryItem } from './components/Terminal';\n\nexport interface RootState {\n\tlocation: string;\n\tconsoleInteractive: boolean;\n\tinventory: string[];\n\thistory: string[];\n\tsoundOn: boolean;\n}\n\nexport enum ActionTypes {\n\tSET_LOCATION = 'SET_LOCATION',\n\tLOCK_CONSOLE = 'LOCK_CONSOLE',\n\tRELEASE_CONSOLE = 'RELEASE_CONSOLE',\n\tADD_TO_INVENTORY = 'ADD_TO_INVENTORY',\n\tPUSH_HISTORY = 'PUSH_HISTORY',\n\tTOGGLE_SOUND = 'TOGGLE_SOUND',\n\tCLEAR_HISTORY = 'CLEAR_HISTORY'\n}\n\ninterface SetLocation {\n\ttype: ActionTypes.SET_LOCATION;\n\tvalue: string;\n}\n\ninterface LockConsole {\n\ttype: ActionTypes.LOCK_CONSOLE;\n}\n\ninterface ReleaseConsole {\n\ttype: ActionTypes.RELEASE_CONSOLE;\n}\n\ninterface AddToInventory {\n\ttype: ActionTypes.ADD_TO_INVENTORY;\n\tvalue: string;\n}\n\ninterface AddToHistory {\n\ttype: ActionTypes.PUSH_HISTORY;\n\tvalue: string;\n}\n\ninterface ClearHistory {\n\ttype: ActionTypes.CLEAR_HISTORY;\n}\n\ninterface ToggleSound {\n\ttype: ActionTypes.TOGGLE_SOUND;\n}\n\nconst initialState: RootState = {\n\tlocation: '',\n\tconsoleInteractive: true,\n\tinventory: [],\n\thistory: [],\n\tsoundOn: true\n};\n\ntype CombinedAction =\n\t| SetLocation\n\t| LockConsole\n\t| ReleaseConsole\n\t| AddToInventory\n\t| AddToHistory\n\t| ToggleSound\n\t| ClearHistory;\n\nfunction reducer(\n\tstate: RootState = initialState,\n\taction: CombinedAction\n): RootState {\n\tswitch (action.type) {\n\t\tcase ActionTypes.SET_LOCATION:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tlocation: action.value\n\t\t\t};\n\t\tcase ActionTypes.LOCK_CONSOLE:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tconsoleInteractive: false\n\t\t\t};\n\t\tcase ActionTypes.RELEASE_CONSOLE:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tconsoleInteractive: true\n\t\t\t};\n\t\tcase ActionTypes.ADD_TO_INVENTORY:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tinventory: [...state.inventory, action.value]\n\t\t\t};\n\t\tcase ActionTypes.PUSH_HISTORY:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\thistory: [...state.history, action.value]\n\t\t\t};\n\t\tcase ActionTypes.CLEAR_HISTORY:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\thistory: []\n\t\t\t};\n\t\tcase ActionTypes.TOGGLE_SOUND:\n\t\t\treturn {\n\t\t\t\t...state,\n\t\t\t\tsoundOn: !state.soundOn\n\t\t\t};\n\t\tdefault:\n\t\t\treturn state;\n\t}\n}\n\nexport function pushToStoreHistory(item: HistoryItem) {\n\treturn {\n\t\ttype: ActionTypes.PUSH_HISTORY,\n\t\tvalue: item.id\n\t};\n}\n\nexport function clearStoreHistory() {\n\treturn { type: ActionTypes.CLEAR_HISTORY };\n}\n\nconst store = createStore(reducer);\n\nexport default store;\n\nexport interface DispatchProps {\n\tdispatch: Dispatch;\n}\n","import store from '../store';\n\nconst voices = speechSynthesis\n\t.getVoices()\n\t.filter(({ lang }) => lang.indexOf('en') >= 0);\n\n// TODO: these voices only exist on Firefox.\n// TODO: the voices may not be loaded yet\nconst moira = voices.filter(voice => voice.name === 'Moira')[0] || voices[0];\nconst victoria =\n\tvoices.filter(voice => voice.name === 'Victoria')[0] || voices[0];\n\nexport default function say(text: string): Promise<null> {\n\tif (!store.getState().soundOn) {\n\t\treturn Promise.resolve(null);\n\t}\n\n\tconst utterance = new SpeechSynthesisUtterance(text);\n\n\tutterance.pitch = 0.8;\n\t// utterance.rate = 0.9;\n\n\tutterance.voice = victoria;\n\n\tif (text[0] === '\"' && text[text.length - 1] === '\"') {\n\t\tutterance.pitch = 1;\n\t\tutterance.rate = 1;\n\t\tutterance.voice = moira;\n\t}\n\n\twindow.speechSynthesis.speak(utterance);\n\n\treturn new Promise(resolve => {\n\t\tutterance.onend = () => {\n\t\t\twindow.setTimeout(resolve, 300);\n\t\t};\n\t});\n}\n\nexport function cancelSpeech(): void {\n\twindow.speechSynthesis.cancel();\n}\n","// simplest UUID implementation\n// https://gist.github.com/jed/982883\n\nexport default function uuid(a?: number): string {\n\treturn a\n\t\t? (a ^ ((Math.random() * 16) >> (a / 4))).toString(16)\n\t\t: (([1e7] as any) + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, uuid);\n}\n","import { HistoryItemContent, HistoryItem } from '../components/Terminal';\nimport say, { cancelSpeech } from './SpeechUtilities';\nimport uuid from './uuid';\nimport store, {\n\tActionTypes,\n\tclearStoreHistory,\n\tpushToStoreHistory\n} from '../store';\nimport { Dispatch } from 'redux';\nimport curry from 'ramda/src/curry';\n\nexport type IOutputterArgs = {\n\tcontent: HistoryItemContent;\n\tspeak?: boolean;\n};\n\nexport type OutputterFunction = (\n\targ1: Dispatch,\n\targ2: IOutputterArgs\n) => Promise<null>;\n\n// TODO: is there a way to infer the type of a curried function,\n// rather than having to hard-code it like this?\nexport type CurriedOutputterFunction = (arg1: IOutputterArgs) => Promise<null>;\n\ninterface RevocableOutputter {\n\trevoke: () => void;\n\toutput: CurriedOutputterFunction;\n}\n\nexport default class OutputController {\n\t// Make the public manifest a readonly clone of the mutable private manifest\n\tprivate static _historyManifest: { [key: string]: HistoryItemContent } = {};\n\tstatic readonly historyManifest = OutputController._historyManifest;\n\n\tprivate static revocableOutputters: RevocableOutputter[] = [];\n\n\tprivate static pushItem(dispatch: Dispatch, item: HistoryItem) {\n\t\tOutputController.historyManifest[item.id] = item.content;\n\t\tdispatch(pushToStoreHistory(item));\n\t}\n\n\tstatic clearHistory(dispatch: Dispatch) {\n\t\tOutputController._historyManifest = {};\n\t\tdispatch(clearStoreHistory());\n\t}\n\n\tstatic getRevocableOutputter(dispatch: Dispatch): CurriedOutputterFunction {\n\t\tlet revoked = false;\n\n\t\tconst curriedOutputter = curry(OutputController.output)(dispatch);\n\n\t\tconst revocableOutputter = {\n\t\t\trevoke: () => {\n\t\t\t\trevoked = true;\n\t\t\t},\n\t\t\toutput: (args: IOutputterArgs) =>\n\t\t\t\trevoked ? Promise.resolve(null) : curriedOutputter(args)\n\t\t};\n\n\t\tOutputController.revocableOutputters.push(revocableOutputter);\n\n\t\treturn revocableOutputter.output;\n\t}\n\n\tstatic output = (\n\t\tdispatch: Dispatch,\n\t\t{ content, speak }: IOutputterArgs\n\t): Promise<null> => {\n\t\tlet speechPromise = Promise.resolve(null);\n\n\t\tif (speak && typeof content === 'string') {\n\t\t\tspeechPromise = say(content);\n\t\t}\n\n\t\tOutputController.pushItem(dispatch, { id: uuid(), content });\n\n\t\treturn speechPromise;\n\t};\n\n\tprivate static revokeOutputters() {\n\t\tOutputController.revocableOutputters.forEach(outputter => {\n\t\t\toutputter.revoke();\n\t\t});\n\n\t\tthis.revocableOutputters = [];\n\t}\n\n\tstatic stopOutput() {\n\t\tthis.revokeOutputters();\n\t\tcancelSpeech();\n\t\tstore.dispatch({ type: ActionTypes.RELEASE_CONSOLE });\n\t}\n}\n","import OutputController, {\n\tCurriedOutputterFunction\n} from '../utils/OutputController';\nimport { Dispatch } from 'redux';\nimport { RootState } from '../store';\n\nexport interface RunParams {\n\targs: string[];\n\tdispatch: Dispatch;\n\tstate: RootState;\n}\n\nexport interface PrivateRunParams extends RunParams {\n\toutput: CurriedOutputterFunction;\n}\n\nexport default abstract class BaseUtility {\n\trun(params: RunParams): Promise<null> {\n\t\tconst output = OutputController.getRevocableOutputter(params.dispatch);\n\n\t\treturn this._run({ ...params, output });\n\t}\n\n\tprotected abstract _run(params: PrivateRunParams): Promise<null>;\n\n\tgetTabCompleteOptions?: (state: RootState, args: string) => string[];\n\n\tcommand: string = '';\n\taliases: string[] = [];\n\thelpDescription: string = '';\n}\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\n\nexport default class Echo extends BaseUtility {\n\tprotected _run({ args, output }: PrivateRunParams): Promise<null> {\n\t\toutput({ content: args.join(' ') });\n\t\treturn Promise.resolve(null);\n\t}\n\n\tcommand = 'echo';\n\thelpDescription =\n\t\t'Use echo to say something out loud. Example:\\n\\necho Is anyone there?';\n\taliases = ['say'];\n}\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\nimport { UtilityManifest, ExtendedUtilityManifest } from './UtilityManifest';\n\nexport default class Help extends BaseUtility {\n\tprotected _run({ output, args }: PrivateRunParams): Promise<null> {\n\t\tif (args.length >= 1) {\n\t\t\tconst util = ExtendedUtilityManifest[args[0]];\n\t\t\tconst description = util\n\t\t\t\t? `${util.helpDescription}${\n\t\t\t\t\t\tutil.aliases.length > 0\n\t\t\t\t\t\t\t? `\\nAliases for this command are: ${[\n\t\t\t\t\t\t\t\t\tutil.command,\n\t\t\t\t\t\t\t\t\t...util.aliases\n\t\t\t\t\t\t\t  ].join(', ')}.`\n\t\t\t\t\t\t\t: ''\n\t\t\t\t  }`\n\t\t\t\t: `I don't know about ${args.join(' ')}.`;\n\n\t\t\toutput({ content: description });\n\t\t} else {\n\t\t\toutput({\n\t\t\t\tcontent: this.helpMessage\n\t\t\t});\n\t\t}\n\n\t\treturn Promise.resolve(null);\n\t}\n\n\tcommand = 'help';\n\thelpDescription = 'Use help to make sense of the world.';\n\n\thelpMessage = `\\\nThe Nature of the Beast\nA work of interactive fiction by Vincent Colavin.\n\nContent warning: This story depicts an emotionally abusive parent-child relationship. Descriptions are spoken out loud by your browser by default. Type \"mute\" to toggle the audio.\n\nHere are some basic commands:\n- List nearby places and objects by typing \"list\". Places are green, and items are blue.\n- Observe your current location by typing \"look\".\n- Examine an object by typing \"look at <object>\".\n- Travel to a location by typing \"go <location>\".\n- Attempt to pick up an object by typing \"pickup <object>\".\n- To view this message at any time, type \"help\".\n\nThe complete list of available commands is: ${Object.keys(UtilityManifest).join(\n\t\t', '\n\t)}.\n\nTo get more details for a command, type \"help <command>\".\n`;\n}\n","interface Args {\n\tslug: string;\n\tdescriptions: string[];\n}\n\nexport default class Location {\n\tconstructor({ descriptions, slug }: Args) {\n\t\tthis.descriptions = descriptions;\n\t\tthis.slug = slug;\n\t}\n\n\thasNeighbor = (neighbor: string): boolean =>\n\t\tthis.neighborSlugs.indexOf(neighbor) >= 0;\n\n\thasItem = (item: string): boolean => this.itemSlugs.indexOf(item) >= 0;\n\n\tdescriptions: string[];\n\tslug: string;\n\titemSlugs: string[] = [];\n\tneighborSlugs: string[] = [];\n}\n","import Location from './Location';\n\nimport locations from '../data/locations.json';\nimport neighbors from '../data/neighbors.json';\nimport items from '../data/items.json';\n\ninterface Neighbors {\n\tfrom: string;\n\tto: string;\n\toneWay?: boolean;\n}\n\nconst LocationManifest: { [s: string]: Location } = {};\n\nlet hasRun: boolean = false;\n\nexport function initializeLocations() {\n\tif (hasRun) {\n\t\treturn;\n\t}\n\n\thasRun = true;\n\n\tlocations.forEach(location => {\n\t\tLocationManifest[location.slug] = new Location(location);\n\t});\n\n\tneighbors.forEach(({ from, to, oneWay }: Neighbors) => {\n\t\tif (!LocationManifest[from]) {\n\t\t\tthrow `${from} is an invalid location`;\n\t\t}\n\n\t\tif (!LocationManifest[to]) {\n\t\t\tthrow `${to} is an invalid location`;\n\t\t}\n\n\t\tLocationManifest[from].neighborSlugs.push(to);\n\n\t\tif (!oneWay) {\n\t\t\tLocationManifest[to].neighborSlugs.push(from);\n\t\t}\n\t});\n\n\titems.forEach(item => {\n\t\tif (!LocationManifest[item.locationSlug]) {\n\t\t\tthrow `${item.slug} has location ${\n\t\t\t\titem.locationSlug\n\t\t\t}, which does not exist`;\n\t\t}\n\n\t\tLocationManifest[item.locationSlug].itemSlugs.push(item.slug);\n\t});\n}\n\nexport default LocationManifest;\n","import React from 'react';\n\nimport BaseUtility, { PrivateRunParams } from './BaseUtility';\nimport { TAB_WIDTH } from '../components/Terminal';\nimport LocationManifest from '../nouns/LocationManifest';\n\ninterface Props {\n\titems: string[];\n\tplaces: string[];\n}\n\nconst LsComponent = (props: Props) => (\n\t<span>\n\t\t{props.places.map(place => (\n\t\t\t<span key={place} className=\"place\">\n\t\t\t\t{place}\n\t\t\t\t{TAB_WIDTH}\n\t\t\t</span>\n\t\t))}\n\t\t{props.items.map(item => (\n\t\t\t<span key={item} className=\"item\">\n\t\t\t\t{item}\n\t\t\t\t{TAB_WIDTH}\n\t\t\t</span>\n\t\t))}\n\t</span>\n);\n\nexport default class Ls extends BaseUtility {\n\tprotected _run({\n\t\toutput,\n\t\tstate: { location }\n\t}: PrivateRunParams): Promise<null> {\n\t\toutput({\n\t\t\tcontent: (\n\t\t\t\t<LsComponent\n\t\t\t\t\tplaces={LocationManifest[location].neighborSlugs.sort()}\n\t\t\t\t\titems={LocationManifest[location].itemSlugs.sort()}\n\t\t\t\t/>\n\t\t\t)\n\t\t});\n\n\t\treturn Promise.resolve(null);\n\t}\n\n\tcommand = 'list';\n\taliases = ['ls'];\n\thelpDescription =\n\t\t'list the locations and objects you can reach from where you are now.';\n}\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\n\nconst responses: string[] = [\n\t\"I don't remember\",\n\t'But I am glad you asked. I am glad you are here.',\n\t\"I don't know who you are\",\n\t\"I'm sorry for that...\",\n\t'To the best of my knowledge, you are an echo.',\n\t'You were a mistake',\n\t'insofar as any human being could be a mistake.'\n];\n\nexport default class WhoAmI extends BaseUtility {\n\tprotected _run({ output }: PrivateRunParams): Promise<null> {\n\t\treturn responses.reduce(\n\t\t\t(memo: Promise<null>, content: string): Promise<null> =>\n\t\t\t\tmemo.then(() => output({ content, speak: true })),\n\t\t\tPromise.resolve(null)\n\t\t);\n\t}\n\n\tcommand = 'whoami';\n\thelpDescription = 'Ask a difficult question. Get a difficult response';\n}\n","interface Args {\n\tslug: string;\n\tlocationSlug: string;\n\tdescriptions: string[];\n\ttakeable: boolean;\n}\n\nexport default class Item {\n\tconstructor({ descriptions, slug, locationSlug, takeable }: Args) {\n\t\tthis.descriptions = descriptions;\n\t\tthis.slug = slug;\n\t\tthis.locationSlug = locationSlug;\n\t\tthis.takeable = takeable;\n\t}\n\n\tdescriptions: string[];\n\tslug: string;\n\tlocationSlug: string;\n\ttakeable: boolean;\n}\n","import Item from './Item';\nimport items from '../data/items.json';\n\nconst ItemManifest: { [s: string]: Item } = {};\n\nlet hasRun: boolean = false;\n\nexport function initializeItems() {\n\tif (hasRun) {\n\t\treturn;\n\t}\n\n\thasRun = true;\n\n\titems.forEach(item => {\n\t\tItemManifest[item.slug] = new Item(item);\n\t});\n}\n\nexport default ItemManifest;\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\nimport ItemManifest from '../nouns/ItemManifest';\nimport LocationManifest from '../nouns/LocationManifest';\nimport { RootState } from '../store';\n\nexport default class Look extends BaseUtility {\n\tprotected _run({\n\t\toutput,\n\t\targs,\n\t\tstate: { location }\n\t}: PrivateRunParams): Promise<null> {\n\t\tlet descriptions: string[];\n\n\t\tconst subject =\n\t\t\targs[0] === 'at' ? ItemManifest[args[1]] : ItemManifest[args[0]];\n\n\t\tif (subject) {\n\t\t\tdescriptions = subject.descriptions;\n\t\t} else {\n\t\t\tdescriptions = LocationManifest[location].descriptions;\n\t\t}\n\n\t\treturn descriptions.reduce(\n\t\t\t(memo: Promise<null>, text: string): Promise<null> =>\n\t\t\t\tmemo.then(() => output({ content: text, speak: true })),\n\t\t\tPromise.resolve(null)\n\t\t);\n\t}\n\n\tgetTabCompleteOptions = ({ location }: RootState, args: string): string[] =>\n\t\tLocationManifest[location].itemSlugs.filter(\n\t\t\t(slug: string) => slug.indexOf(args) === 0\n\t\t);\n\n\tcommand = 'look';\n\taliases = ['l'];\n\thelpDescription = 'Use look to take a good look around.';\n}\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\nimport { ActionTypes, RootState } from '../store';\nimport LocationManifest from '../nouns/LocationManifest';\n\nexport default class Cd extends BaseUtility {\n\tprotected _run({\n\t\targs,\n\t\toutput,\n\t\tdispatch\n\t}: PrivateRunParams): Promise<null> {\n\t\tconst nullPromise = Promise.resolve(null);\n\n\t\tif (args.length === 0) {\n\t\t\toutput({ content: 'location must be specified' });\n\t\t\treturn nullPromise;\n\t\t}\n\n\t\tconst locationChain = args[0].split('/').filter(l => l);\n\n\t\tconst finalLocation = locationChain[locationChain.length - 1];\n\t\tif (this.locationChainValid(locationChain)) {\n\t\t\tdispatch({\n\t\t\t\ttype: ActionTypes.SET_LOCATION,\n\t\t\t\tvalue: finalLocation\n\t\t\t});\n\n\t\t\tsetUrlLocation({\n\t\t\t\tlocation: finalLocation\n\t\t\t});\n\t\t} else {\n\t\t\toutput({ content: `${finalLocation} is not a valid location` });\n\t\t}\n\n\t\treturn nullPromise;\n\t}\n\n\tgetTabCompleteOptions = (\n\t\t{ location }: RootState,\n\t\tpath: string\n\t): string[] => {\n\t\tconst locations = path.split('/');\n\n\t\tconst locationChain = locations.splice(0, locations.length - 1);\n\t\tconst finalFragment = locations[locations.length - 1];\n\n\t\tif (!this.locationChainValid(locationChain)) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst finalLocationInChain =\n\t\t\tlocationChain.length === 0\n\t\t\t\t? LocationManifest[location]\n\t\t\t\t: LocationManifest[locationChain[locationChain.length - 1]];\n\n\t\tif (!finalLocationInChain) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst options = finalLocationInChain.neighborSlugs.filter(\n\t\t\t(slug: string) => slug.indexOf(finalFragment) === 0\n\t\t);\n\n\t\tif (options.length === 1) {\n\t\t\tconst path =\n\t\t\t\tlocationChain.length === 0 ? '' : `${locationChain.join('/')}/`;\n\t\t\treturn [`${path}${options[0]}/`];\n\t\t}\n\n\t\treturn options;\n\t};\n\n\tprivate locationChainValid = (locations: string[]): boolean => {\n\t\tif (locations.length === 0) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// for some reason TS won't let me return the result of this reduce directly\n\t\tconst valid = locations.reduce((memo, location, i, locations) => {\n\t\t\tif (i === 0) {\n\t\t\t\treturn !!LocationManifest[location];\n\t\t\t}\n\n\t\t\tconst prevLocation = LocationManifest[locations[i - 1]];\n\n\t\t\treturn memo && prevLocation.hasNeighbor(location);\n\t\t}, true);\n\n\t\treturn valid;\n\t};\n\n\tcommand = 'goto';\n\taliases = ['cd', 'go', 'g'];\n\thelpDescription =\n\t\t'Use goto to move to a new location. For example:\\n\\n goto a_cold_cabin';\n}\n\nexport function setUrlLocation({ location }: { location: string }): void {\n\twindow.location.hash = location;\n}\n","import React from 'react';\nimport BaseUtility, { PrivateRunParams } from './BaseUtility';\n\ninterface State {\n\tcontent: string;\n}\n\nclass TimeComponent extends React.Component<{}, State> {\n\tprivate interval: number = 0;\n\n\tstate: State = {\n\t\tcontent: new Date().getTime().toString()\n\t};\n\n\tcomponentDidMount() {\n\t\tthis.interval = window.setInterval(() => {\n\t\t\tthis.setState({ content: new Date().getTime().toString() });\n\t\t}, 1000);\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.clearInterval(this.interval);\n\t}\n\n\trender() {\n\t\treturn this.state.content;\n\t}\n}\n\nexport default class Time extends BaseUtility {\n\tprotected _run({ output }: PrivateRunParams): Promise<null> {\n\t\toutput({ content: <TimeComponent /> });\n\n\t\treturn Promise.resolve(null);\n\t}\n\n\tcommand = 'time';\n\thelpDescription = 'time tells you the time';\n}\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\nimport { ActionTypes } from '../store';\nimport ItemManifest from '../nouns/ItemManifest';\nimport LocationManifest from '../nouns/LocationManifest';\n\nexport default class Pickup extends BaseUtility {\n\tprotected _run({\n\t\targs,\n\t\toutput,\n\t\tstate: { location },\n\t\tdispatch\n\t}: PrivateRunParams): Promise<null> {\n\t\tconst item = args[0];\n\t\tconst currentLocation = LocationManifest[location];\n\n\t\tif (ItemManifest[item] && currentLocation.hasItem(item)) {\n\t\t\tif (ItemManifest[item].takeable) {\n\t\t\t\tcurrentLocation.itemSlugs = currentLocation.itemSlugs.filter(\n\t\t\t\t\titemSlug => itemSlug !== item\n\t\t\t\t);\n\n\t\t\t\tdispatch({\n\t\t\t\t\ttype: ActionTypes.ADD_TO_INVENTORY,\n\t\t\t\t\tvalue: item\n\t\t\t\t});\n\n\t\t\t\toutput({ content: `You have picked up ${item}` });\n\t\t\t} else {\n\t\t\t\toutput({ content: `You cannot pick up ${item}` });\n\t\t\t}\n\t\t} else {\n\t\t\toutput({ content: `There is no ${item} here` });\n\t\t}\n\n\t\treturn Promise.resolve(null);\n\t}\n\n\tcommand = 'get';\n\thelpDescription =\n\t\t'pickup will allow you to add an object to your inventory';\n\taliases = ['pickup', 'grab', 'take'];\n}\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\nimport { TAB_WIDTH } from '../components/Terminal';\n\nexport default class Inventory extends BaseUtility {\n\tprotected _run({\n\t\toutput,\n\t\tstate: { inventory }\n\t}: PrivateRunParams): Promise<null> {\n\t\toutput({ content: inventory.join(TAB_WIDTH) });\n\t\treturn Promise.resolve(null);\n\t}\n\n\tcommand = 'inventory';\n\thelpDescription = 'List all the items currently in your inventory.';\n\taliases = ['inv'];\n}\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\nimport { ActionTypes } from '../store';\n\nexport default class Mute extends BaseUtility {\n\tprotected _run({\n\t\toutput,\n\t\tdispatch,\n\t\tstate: { soundOn }\n\t}: PrivateRunParams): Promise<null> {\n\t\tdispatch({ type: ActionTypes.TOGGLE_SOUND });\n\n\t\toutput({\n\t\t\tcontent: `Sound has been turned ${soundOn ? 'off' : 'on'}.`\n\t\t});\n\n\t\treturn Promise.resolve(null);\n\t}\n\n\tcommand = 'mute';\n\taliases = ['quiet'];\n\thelpDescription =\n\t\t'toggle whether descriptions generated by \"look\" should be read out loud';\n}\n","import BaseUtility, { PrivateRunParams } from './BaseUtility';\nimport OutputController from '../utils/OutputController';\n\nexport default class Clear extends BaseUtility {\n\tprotected _run({ dispatch }: PrivateRunParams): Promise<null> {\n\t\tOutputController.clearHistory(dispatch);\n\t\treturn Promise.resolve(null);\n\t}\n\n\tcommand = 'clear';\n\thelpDescription = 'Clears the screen.';\n\taliases = ['cl'];\n}\n","import Echo from './Echo';\nimport Help from './Help';\nimport BaseUtility from './BaseUtility';\nimport Ls from './Ls';\nimport WhoAmI from './WhoAmI';\nimport Look from './Look';\nimport Cd from './Cd';\nimport Time from './Time';\nimport Pickup from './Pickup';\nimport Inventory from './Inventory';\nimport Mute from './Mute';\nimport Clear from './Clear';\n\nexport const UtilityManifest: { [s: string]: BaseUtility } = {};\nexport const ExtendedUtilityManifest: { [s: string]: BaseUtility } = {};\n\nlet hasRun: boolean = false;\n\nexport function initializeUtilities() {\n\tif (hasRun) {\n\t\treturn;\n\t}\n\n\thasRun = true;\n\n\tconst utilities = [\n\t\tnew Echo(),\n\t\tnew Help(),\n\t\tnew Ls(),\n\t\tnew WhoAmI(),\n\t\tnew Cd(),\n\t\tnew Look(),\n\t\tnew Time(),\n\t\tnew Pickup(),\n\t\tnew Inventory(),\n\t\tnew Mute(),\n\t\tnew Clear()\n\t];\n\n\tutilities.forEach(utility => {\n\t\tUtilityManifest[utility.command] = utility;\n\n\t\tExtendedUtilityManifest[utility.command] = utility;\n\n\t\tutility.aliases.forEach(alias => {\n\t\t\tExtendedUtilityManifest[alias] = utility;\n\t\t});\n\t});\n}\n","import React from 'react';\nimport { RootState } from '../store';\nimport { connect } from 'react-redux';\nimport OutputController from '../utils/OutputController';\n\ninterface Props {\n\tterminalHistory: string[];\n}\n\nfunction TerminalBuffer({ terminalHistory }: Props) {\n\treturn (\n\t\t<div className=\"terminal-buffer\">\n\t\t\t{terminalHistory.map(itemId => (\n\t\t\t\t<p className=\"terminal-buffer-item\" key={itemId}>\n\t\t\t\t\t{OutputController.historyManifest[itemId]}\n\t\t\t\t</p>\n\t\t\t))}\n\t\t</div>\n\t);\n}\n\nconst mapStateToProps = ({ history }: RootState): Props => ({\n\tterminalHistory: history\n});\n\nexport default connect(mapStateToProps)(TerminalBuffer);\n","import React from 'react';\nimport { DispatchProps, RootState } from '../store';\nimport { TAB_WIDTH, inputPrompt } from './Terminal';\nimport uuid from '../utils/uuid';\nimport OutputController from '../utils/OutputController';\nimport { ExtendedUtilityManifest } from '../utilities/UtilityManifest';\nimport { connect } from 'react-redux';\nimport LocationManifest from '../nouns/LocationManifest';\n\ninterface CommandItem {\n\tcontent: string;\n\tid: string;\n}\n\ninterface OwnProps {\n\thandleSubmit: (arg: string) => void;\n}\n\ntype StoreProps = Pick<RootState, 'inventory' | 'location'> & {\n\t_state: RootState;\n};\n\ntype Props = OwnProps & StoreProps & DispatchProps;\n\ninterface State {\n\tcommandHistory: CommandItem[];\n\tcurrentPlaceInHistory: number;\n\tinputValue: string;\n}\n\nclass TerminalInput extends React.Component<Props, State> {\n\tstate: State = {\n\t\tcommandHistory: [],\n\t\tcurrentPlaceInHistory: -1,\n\t\tinputValue: ''\n\t};\n\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\t\tthis.inputEl = React.createRef();\n\t}\n\n\tprivate inputEl: React.RefObject<HTMLInputElement>;\n\n\tprivate focusInput = () => {\n\t\tthis.inputEl.current && this.inputEl.current.focus();\n\t};\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener('click', this.focusInput);\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('click', this.focusInput);\n\t}\n\n\tprivate goBackInHistory = () => {\n\t\tthis.setState(\n\t\t\tstate => {\n\t\t\t\tif (\n\t\t\t\t\tstate.currentPlaceInHistory ===\n\t\t\t\t\tstate.commandHistory.length - 1\n\t\t\t\t) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tcurrentPlaceInHistory: state.currentPlaceInHistory + 1\n\t\t\t\t};\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tconst command = this.state.commandHistory[\n\t\t\t\t\tthis.state.currentPlaceInHistory\n\t\t\t\t];\n\n\t\t\t\tif (command) {\n\t\t\t\t\tthis.setState({ inputValue: command.content });\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t};\n\n\tprivate goForwardInHistory = () => {\n\t\tthis.setState(\n\t\t\tstate => {\n\t\t\t\tif (state.currentPlaceInHistory === -1) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tcurrentPlaceInHistory: state.currentPlaceInHistory - 1\n\t\t\t\t};\n\t\t\t},\n\t\t\t() => {\n\t\t\t\tif (this.state.currentPlaceInHistory === -1) {\n\t\t\t\t\tthis.setState({ inputValue: '' });\n\t\t\t\t}\n\n\t\t\t\tconst command = this.state.commandHistory[\n\t\t\t\t\tthis.state.currentPlaceInHistory\n\t\t\t\t];\n\n\t\t\t\tif (command) {\n\t\t\t\t\tthis.setState({ inputValue: command.content });\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\t};\n\n\tprivate moveCursorToEnd = () => {\n\t\twindow.setTimeout(() => {\n\t\t\tif (this.inputEl.current) {\n\t\t\t\tthis.inputEl.current.selectionStart = 1000;\n\t\t\t}\n\t\t}, 0);\n\t};\n\n\tprivate handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.setState({ inputValue: (e.target as HTMLInputElement).value });\n\t};\n\n\tprivate handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tswitch (e.key) {\n\t\t\tcase 'ArrowUp':\n\t\t\t\tthis.goBackInHistory();\n\t\t\t\tthis.moveCursorToEnd();\n\t\t\t\tbreak;\n\t\t\tcase 'ArrowDown':\n\t\t\t\tthis.goForwardInHistory();\n\t\t\t\tthis.moveCursorToEnd();\n\t\t\t\tbreak;\n\t\t\tcase 'Tab':\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.tabComplete();\n\t\t\t\tbreak;\n\t\t\tcase 'Enter':\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.addToCommandHistory(this.state.inputValue);\n\t\t\t\tthis.props.handleSubmit(this.state.inputValue);\n\t\t\t\tthis.setState({ inputValue: '' });\n\n\t\t\tdefault:\n\t\t}\n\t};\n\n\tprivate addToCommandHistory = (value: string) => {\n\t\tthis.setState(state => ({\n\t\t\tcommandHistory: [\n\t\t\t\t{\n\t\t\t\t\tcontent: value,\n\t\t\t\t\tid: uuid()\n\t\t\t\t},\n\t\t\t\t...state.commandHistory\n\t\t\t],\n\t\t\tcurrentPlaceInHistory: -1\n\t\t}));\n\t};\n\n\tprivate tabComplete = () => {\n\t\tconst [command, ...rest] = this.state.inputValue.split(' ');\n\n\t\tif (rest.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lastValue = rest[rest.length - 1] || '';\n\n\t\tconst utility = ExtendedUtilityManifest[command];\n\n\t\tconst { _state, inventory, location: locationString } = this.props;\n\t\tconst location = LocationManifest[locationString];\n\n\t\tconst options =\n\t\t\tutility && utility.getTabCompleteOptions\n\t\t\t\t? utility.getTabCompleteOptions(_state, lastValue)\n\t\t\t\t: [\n\t\t\t\t\t\t...location.neighborSlugs,\n\t\t\t\t\t\t...location.itemSlugs,\n\t\t\t\t\t\t...inventory\n\t\t\t\t  ].filter((slug: string) => slug.indexOf(lastValue) === 0);\n\n\t\tswitch (options.length) {\n\t\t\tcase 0:\n\t\t\t\tbreak;\n\t\t\tcase 1:\n\t\t\t\tconst newValue = [\n\t\t\t\t\tcommand,\n\t\t\t\t\t...rest.slice(0, rest.length - 1),\n\t\t\t\t\toptions[0]\n\t\t\t\t].join(' ');\n\t\t\t\tthis.setState({ inputValue: newValue });\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconst { dispatch } = this.props;\n\t\t\t\tOutputController.output(dispatch, {\n\t\t\t\t\tcontent: `${inputPrompt(locationString)}${\n\t\t\t\t\t\tthis.state.inputValue\n\t\t\t\t\t}`\n\t\t\t\t});\n\t\t\t\tOutputController.output(dispatch, {\n\t\t\t\t\tcontent: options.join(TAB_WIDTH)\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<input\n\t\t\t\tclassName=\"input\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tonKeyDown={this.handleKeyDown}\n\t\t\t\tonChange={this.handleChange}\n\t\t\t\tref={this.inputEl}\n\t\t\t\tvalue={this.state.inputValue}\n\t\t\t/>\n\t\t);\n\t}\n}\n\nconst mapStateToProps = (\n\tstate: RootState,\n\t{ handleSubmit }: OwnProps\n): OwnProps & StoreProps => ({\n\t_state: state,\n\tlocation: state.location,\n\tinventory: state.inventory,\n\thandleSubmit\n});\n\nexport default connect(mapStateToProps)(TerminalInput);\n","import React from 'react';\nimport { ExtendedUtilityManifest } from '../utilities/UtilityManifest';\nimport { ActionTypes, RootState, DispatchProps } from '../store';\nimport { connect } from 'react-redux';\nimport TerminalBuffer from './TerminalBuffer';\nimport TerminalInput from './TerminalInput';\nimport OutputController from '../utils/OutputController';\n\nexport type HistoryItemContent = string | JSX.Element;\n\nexport interface HistoryItem {\n\tcontent: HistoryItemContent;\n\tid: string;\n}\n\ninterface StoreProps\n\textends Pick<RootState, 'consoleInteractive' | 'location'> {\n\t_state: RootState;\n}\n\ninterface Props extends StoreProps, DispatchProps {}\n\nexport function inputPrompt(location: string): string {\n\treturn `~/${location} > `;\n}\n\nexport const TAB_WIDTH = '    ';\n\nclass Terminal extends React.Component<Props, {}> {\n\tprivate handleKeydown = (e: Event) => {\n\t\tconst typedEvent = (e as any) as React.KeyboardEvent;\n\n\t\tconst { key } = typedEvent;\n\n\t\tif (\n\t\t\tkey === 'Escape' ||\n\t\t\t(typedEvent.ctrlKey && ['c', 'C', 'd', 'D'].indexOf(key) >= 0)\n\t\t) {\n\t\t\tOutputController.stopOutput();\n\t\t}\n\t};\n\n\tcomponentDidMount() {\n\t\twindow.addEventListener('keydown', this.handleKeydown);\n\t}\n\n\tcomponentWillUnmount() {\n\t\twindow.removeEventListener('keydown', this.handleKeydown);\n\t}\n\n\tprivate runCommand = (value: string) => {\n\t\tconst { dispatch, _state, location } = this.props;\n\n\t\tconst [utilityName, ...args] = value.trim().split(' ');\n\t\tconst utility = ExtendedUtilityManifest[utilityName];\n\n\t\tOutputController.output(dispatch, {\n\t\t\tcontent: `${inputPrompt(location)}${value}`\n\t\t});\n\n\t\tif (utility) {\n\t\t\tdispatch({ type: ActionTypes.LOCK_CONSOLE });\n\n\t\t\tutility\n\t\t\t\t.run({ args, dispatch, state: _state })\n\t\t\t\t.then(() => {\n\t\t\t\t\tdispatch({ type: ActionTypes.RELEASE_CONSOLE });\n\t\t\t\t})\n\t\t\t\t.catch(console.error);\n\t\t} else {\n\t\t\tOutputController.output(dispatch, {\n\t\t\t\tcontent: `I don't know how to ${utilityName}`\n\t\t\t});\n\t\t}\n\t};\n\n\trender() {\n\t\tconst { consoleInteractive, location } = this.props;\n\n\t\treturn (\n\t\t\t<div className=\"terminal\">\n\t\t\t\t<TerminalBuffer />\n\n\t\t\t\t<form\n\t\t\t\t\tclassName={`input-form ${\n\t\t\t\t\t\tconsoleInteractive ? 'active' : ''\n\t\t\t\t\t}`}\n\t\t\t\t>\n\t\t\t\t\t<span className=\"input-prompt\">\n\t\t\t\t\t\t{inputPrompt(location)}\n\t\t\t\t\t</span>\n\n\t\t\t\t\t<TerminalInput handleSubmit={this.runCommand} />\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t);\n\t}\n}\n\n// state is passed through with the underscore prefix\n// to indicate it is only present to be passed through to utilities\nconst mapStateToProps = (state: RootState): StoreProps => ({\n\t_state: state,\n\tconsoleInteractive: state.consoleInteractive,\n\tlocation: state.location\n});\n\nexport default connect(mapStateToProps)(Terminal);\n","import React from 'react';\nimport Terminal from './Terminal';\nimport { initializeLocations } from '../nouns/LocationManifest';\nimport {\n\tinitializeUtilities,\n\tUtilityManifest\n} from '../utilities/UtilityManifest';\nimport store, { ActionTypes, RootState, DispatchProps } from '../store';\nimport { initializeItems } from '../nouns/ItemManifest';\nimport { setUrlLocation } from '../utilities/Cd';\nimport { connect } from 'react-redux';\n\nconst INITIAL_LOCATION_SLUG = 'a_quiet_forest';\n\ninterface StoreProps {\n\tstate: RootState;\n}\n\ninterface Props extends DispatchProps, StoreProps {}\n\nclass App extends React.Component<Props, {}> {\n\tconstructor(props: Props) {\n\t\tsuper(props);\n\n\t\tconst { dispatch, state } = props;\n\n\t\tinitializeLocations();\n\t\tinitializeUtilities();\n\t\tinitializeItems();\n\n\t\tsetUrlLocation({ location: INITIAL_LOCATION_SLUG });\n\n\t\tstore.dispatch({\n\t\t\ttype: ActionTypes.SET_LOCATION,\n\t\t\tvalue: INITIAL_LOCATION_SLUG\n\t\t});\n\n\t\tconst helpUtility = UtilityManifest['help'];\n\n\t\thelpUtility.run({ args: [], dispatch, state });\n\t}\n\n\trender() {\n\t\treturn <Terminal />;\n\t}\n}\n\nconst mapStateToProps = (state: RootState): StoreProps => ({\n\tstate\n});\n\nexport default connect(mapStateToProps)(App);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './styles/index.scss';\nimport App from './components/App';\n\nimport { Provider } from 'react-redux';\nimport store from './store';\n\nReactDOM.render(\n\t<Provider store={store}>\n\t\t<App />\n\t</Provider>,\n\tdocument.getElementById('root')\n);\n"],"sourceRoot":""}